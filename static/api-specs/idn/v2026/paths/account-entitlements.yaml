get:
  operationId: getAccountEntitlements
  tags:
    - Entitlements
  summary: Get entitlements for an account
  description:
    This API returns a list of all entitlements associated with the given account ID.
    The account must exist; if not found, the API returns 404.
  security:
    - userAuth: ['idn:entitlement:read']
  x-sailpoint-userLevels:
    - ORG_ADMIN
  parameters:
    - in: path
      name: accountId
      schema:
        type: string
      required: true
      description: The account ID to get entitlements for
      example: ef38f94347e94562b5bb8424a56397d8
      x-sailpoint-resource-operation-id: listAccounts
    - $ref: '../parameters/limit.yaml'
    - $ref: '../parameters/offset.yaml'
    - $ref: '../parameters/count.yaml'
  responses:
    '200':
      description: List of entitlements for the account
      headers:
        total-count:
          description: Total number of results (when count is requested).
          schema:
            type: integer
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '../schemas/Entitlement.yaml'
          example:
            [
              {
                "sourceSchemaObjectType": "group",
                "attribute": "memberOf",
                "attributes": {
                  "GroupType": "Security",
                  "sAMAccountName": "Account Payable",
                  "GroupScope": "Global",
                  "objectguid": "{01a6e70b-9705-4155-a5c6-492a9bcc8c64}",
                  "objectSid": "S-1-5-21-3585869415-1648031554-2909195034-1633",
                  "cn": "Account Payable",
                  "msDS-PrincipalName": "AUTOMATIONAD\\Account Payable"
                },
                "value": "CN=Account Payable,OU=Finance,DC=xyz company",
                "description": "This entitlement allows users to access the accounts payable module of the organization's financial management system. Users can view, process, and approve invoices, manage vendor relationships, and perform other accounts payable-related tasks.",
                "privilegeLevel": null,
                "cloudGoverned": false,
                "source": {
                  "type": "SOURCE",
                  "id": "2c9180877504c40e0175097d5ce707c8",
                  "name": "EndToEnd-ADSource"
                },
                "owner": {
                  "id": "2a2fdacca5e345f18bf7970cfbb8fec2",
                  "name": "identity 1",
                  "type": "IDENTITY"
                },
                "segments": [
                  "1d126fe0-45e2-4aea-bc64-a07e9344ef26"
                ],
                "manuallyUpdatedFields": {
                  "DISPLAY_NAME": true,
                  "DESCRIPTION": true
                },
                "id": "2c91808c74ff913f0175097daa9d59cd",
                "name": "Account Payable",
                "created": "2020-10-08T18:33:52.029Z",
                "modified": "2021-01-19T16:53:35.707Z"
              }
            ]
    '400':
      $ref: '../responses/400.yaml'
    '401':
      $ref: '../responses/401.yaml'
    '403':
      $ref: '../responses/403.yaml'
    '404':
      $ref: '../responses/404.yaml'
    '429':
      $ref: '../responses/429.yaml'
    '500':
      $ref: '../responses/500.yaml'
